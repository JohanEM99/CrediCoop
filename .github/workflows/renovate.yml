name: Renovate

on:
  schedule:
    - cron: "0 3 1 * *" # Ejecutar solo 1 vez al mes
  workflow_dispatch:       # Permite ejecutarlo manualmente

jobs:
  renovate:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Run Renovate
        uses: renovatebot/github-action@v44.0.3
        with:
          renovate-version: full
        env:
          RENOVATE_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Mostrar estado de actualizaciones
        run: |
          echo "----------------------------------------"
          echo "Revisando si hubo actualizaciones..."
          echo "----------------------------------------"

          if grep -qi '"prOpened": true' renovate.log.json; then
            echo "Renovate abrió nuevas Pull Requests con actualizaciones."
          else
            echo "No había actualizaciones disponibles para aplicar."
          fi
          
          echo "----------------------------------------"
          echo "Proceso completado."
          echo "----------------------------------------"
